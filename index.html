<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Stats - –ê–Ω–∞–ª–∏–∑ –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --tg-blue: #3390ec;
            --tg-blue-dark: #2481da;
            --tg-bg: #1e1e1e;
            --tg-bg-secondary: #2d2d2d;
            --tg-bg-light: #3a3a3a;
            --tg-text: #ffffff;
            --tg-text-secondary: #aaaaaa;
            --tg-border: #3a3a3a;
            --tg-green: #32a955;
            --tg-purple: #9b59b6;
            --tg-orange: #e67e22;
            --tg-red: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
        }

        body {
            background: var(--tg-bg);
            color: var(--tg-text);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px 0;
            border-bottom: 1px solid var(--tg-border);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo-icon {
            background: var(--tg-blue);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--tg-blue), var(--tg-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: var(--tg-text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .login-section {
            background: var(--tg-bg-secondary);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .login-btn {
            background: var(--tg-blue);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 10px;
        }

        .login-btn:hover {
            background: var(--tg-blue-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(51, 144, 236, 0.4);
        }

        .login-btn.secondary {
            background: var(--tg-bg-light);
            color: var(--tg-text);
        }

        .login-btn.secondary:hover {
            background: var(--tg-purple);
        }

        .stats-section {
            display: none;
        }

        .user-card {
            background: var(--tg-bg-secondary);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--tg-blue), var(--tg-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 700;
            color: white;
            flex-shrink: 0;
        }

        .user-avatar-img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-info h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .user-info p {
            color: var(--tg-text-secondary);
            font-size: 16px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--tg-bg-secondary);
            border-radius: 16px;
            padding: 25px;
            transition: all 0.3s ease;
            border-left: 4px solid var(--tg-blue);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .stat-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--tg-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .stat-title {
            font-size: 18px;
            font-weight: 600;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--tg-blue);
        }

        .stat-description {
            color: var(--tg-text-secondary);
            font-size: 14px;
        }

        .highlight-card {
            background: linear-gradient(135deg, var(--tg-blue), var(--tg-purple));
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(51, 144, 236, 0.3);
        }

        .highlight-value {
            font-size: 42px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .highlight-label {
            font-size: 18px;
            opacity: 0.9;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: var(--tg-text-secondary);
            display: none;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(51, 144, 236, 0.3);
            border-top: 5px solid var(--tg-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: var(--tg-red);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }

        .chart-container {
            background: var(--tg-bg-secondary);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .chart-title {
            font-size: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart {
            height: 200px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            padding: 20px 0;
        }

        .chart-bar {
            flex: 1;
            background: var(--tg-blue);
            border-radius: 5px 5px 0 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .chart-bar:hover {
            opacity: 0.8;
        }

        .chart-label {
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 12px;
            color: var(--tg-text-secondary);
        }

        .logout-btn {
            background: transparent;
            color: var(--tg-text-secondary);
            border: 1px solid var(--tg-border);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .logout-btn:hover {
            background: var(--tg-red);
            color: white;
            border-color: var(--tg-red);
        }

        .instructions {
            background: var(--tg-bg-light);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            font-size: 14px;
        }

        .instructions h3 {
            margin-bottom: 10px;
            color: var(--tg-blue);
        }

        footer {
            text-align: center;
            padding: 30px 0;
            color: var(--tg-text-secondary);
            font-size: 14px;
            border-top: 1px solid var(--tg-border);
            margin-top: 40px;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .user-card {
                flex-direction: column;
                text-align: center;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fab fa-telegram"></i>
                </div>
                <h1>Telegram Stats</h1>
            </div>
            <p class="subtitle">–£–∑–Ω–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∞—à–µ–≥–æ Telegram –∞–∫–∫–∞—É–Ω—Ç–∞: –æ—Ç –¥–∞—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–æ —Å–∞–º—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å—Ç–∏–∫–µ—Ä–æ–≤</p>
        </header>

        <div class="error" id="errorMessage">
            <i class="fas fa-exclamation-triangle"></i> <span id="errorText">–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞</span>
        </div>

        <div class="login-section" id="loginSection">
            <h2>–í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç Telegram</h2>
            <p>–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è. –ú—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.</p>
            
            <div class="instructions">
                <h3>–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ –¥–ª—è OAuth:</h3>
                <p>1. –ù–∞–ø–∏—à–∏—Ç–µ <strong>@BotFather</strong> –≤ Telegram</p>
                <p>2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É <code>/newbot</code></p>
                <p>3. –£–∫–∞–∂–∏—Ç–µ –∏–º—è –∏ username –±–æ—Ç–∞</p>
                <p>4. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞</p>
                <p>5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</p>
            </div>

            <div>
                <button class="login-btn" id="webAppBtn">
                    <i class="fab fa-telegram"></i> –û—Ç–∫—Ä—ã—Ç—å –≤ Telegram Web App
                </button>
                <button class="login-btn secondary" id="demoBtn">
                    <i class="fas fa-eye"></i> –î–µ–º–æ-—Ä–µ–∂–∏–º
                </button>
            </div>

            <div style="margin-top: 30px; padding: 20px; background: var(--tg-bg-light); border-radius: 12px;">
                <h3>–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å –¥–µ–º–æ-—Ä–µ–∂–∏–º–æ–º</h3>
                <p>–ù–∞–∂–º–∏—Ç–µ "–î–µ–º–æ-—Ä–µ–∂–∏–º" —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞</p>
            </div>
        </div>

        <div class="loading" id="loadingSection">
            <div class="loading-spinner"></div>
            <p>–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞...</p>
        </div>

        <div class="stats-section" id="statsSection">
            <div class="user-card">
                <div class="avatar" id="userAvatar">
                    <!-- Avatar will be inserted here -->
                </div>
                <div class="user-info">
                    <h2 id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
                    <p id="userStatus">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
                </div>
            </div>

            <div class="highlight-card">
                <div class="highlight-value" id="accountAge">0</div>
                <div class="highlight-label">–¥–Ω–µ–π —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ Telegram</div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-title">–ü—É–±–ª–∏—á–Ω—ã–µ —á–∞—Ç—ã</div>
                    </div>
                    <div class="stat-value" id="publicChats">0</div>
                    <div class="stat-description">–£—á–∞—Å—Ç–Ω–∏–∫ –≤ —Å—Ç–æ–ª—å–∫–∏—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö —á–∞—Ç–∞—Ö</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-comment"></i>
                        </div>
                        <div class="stat-title">–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                    </div>
                    <div class="stat-value" id="totalMessages">0</div>
                    <div class="stat-description">–ù–∞–ø–∏—Å–∞–Ω–æ –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —á–∞—Ç–∞—Ö</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-microphone"></i>
                        </div>
                        <div class="stat-title">–ì–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                    </div>
                    <div class="stat-value" id="voiceMessages">0</div>
                    <div class="stat-description">–ó–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤–∞–º–∏</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-video"></i>
                        </div>
                        <div class="stat-title">–í–∏–¥–µ–æ —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                    </div>
                    <div class="stat-value" id="videoMessages">0</div>
                    <div class="stat-description">–ö—Ä—É–∂–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –∑–∞–ø–∏—Å–∞–ª–∏</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-title">–°–∞–º–æ–µ –∞–∫—Ç–∏–≤–Ω–æ–µ –≤—Ä–µ–º—è</div>
                    </div>
                    <div class="stat-value" id="activeTime">-</div>
                    <div class="stat-description">–ö–æ–≥–¥–∞ –≤—ã —á–∞—â–µ –≤—Å–µ–≥–æ –≤ Telegram</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <div class="stat-title">–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</div>
                    </div>
                    <div class="stat-value" id="lastMessage">-</div>
                    <div class="stat-description">–î–∞—Ç–∞ –≤–∞—à–µ–≥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="stat-title">–°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç</div>
                    </div>
                    <div class="stat-value" id="fastestReply">0</div>
                    <div class="stat-description">—Å–µ–∫—É–Ω–¥ - –≤–∞—à —Ä–µ–∫–æ—Ä–¥ —Å–∫–æ—Ä–æ—Å—Ç–∏</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-font"></i>
                        </div>
                        <div class="stat-title">–ß–∞—Å—Ç—ã–µ —Å–ª–æ–≤–∞</div>
                    </div>
                    <div class="stat-value" id="commonWords">-</div>
                    <div class="stat-description">–í–∞—à–∏ —Å–∞–º—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–ª–æ–≤–∞</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-title">–ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</div>
                    </div>
                    <div class="stat-value" id="firstMessage">-</div>
                    <div class="stat-description">–î–∞—Ç–∞ –≤–∞—à–µ–≥–æ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-user-edit"></i>
                        </div>
                        <div class="stat-title">–ü—Ä–æ—à–ª—ã–µ —é–∑–µ—Ä–Ω–µ–π–º—ã</div>
                    </div>
                    <div class="stat-value" id="pastUsernames">0</div>
                    <div class="stat-description">–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤—ã –º–µ–Ω—è–ª–∏ username</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-smile"></i>
                        </div>
                        <div class="stat-title">–ü–æ–ø—É–ª—è—Ä–Ω—ã–π —Å—Ç–∏–∫–µ—Ä</div>
                    </div>
                    <div class="stat-value" id="commonSticker">-</div>
                    <div class="stat-description">–í–∞—à —Å–∞–º—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Å—Ç–∏–∫–µ—Ä</div>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <i class="fas fa-chart-bar"></i> –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
                </div>
                <div class="chart" id="activityChart">
                    <!-- Chart bars will be generated by JavaScript -->
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    <i class="fas fa-chart-pie"></i> –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π
                </div>
                <div class="chart" id="messageTypesChart">
                    <!-- Chart bars will be generated by JavaScript -->
                </div>
            </div>

            <div style="text-align: center;">
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                </button>
            </div>
        </div>

        <footer>
            <p>Telegram Stats &copy; 2023 | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–º–æ-—Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</p>
            <p>–î–ª—è OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather</p>
        </footer>
    </div>

    <script>
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const loginSection = document.getElementById('loginSection');
        const statsSection = document.getElementById('statsSection');
        const loadingSection = document.getElementById('loadingSection');
        const errorMessage = document.getElementById('errorMessage');
        const webAppBtn = document.getElementById('webAppBtn');
        const demoBtn = document.getElementById('demoBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –æ—à–∏–±–∫–∏
        function showError(message) {
            document.getElementById('errorText').textContent = message;
            errorMessage.style.display = 'block';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –æ—à–∏–±–∫–∏
        function hideError() {
            errorMessage.style.display = 'none';
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –≤ Telegram Web App
        function openInTelegramWebApp() {
            const currentUrl = window.location.href;
            const telegramWebAppUrl = `https://t.me/share/url?url=${encodeURIComponent(currentUrl)}&text=Telegram Stats - –ü–æ—Å–º–æ—Ç—Ä–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–≤–æ–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞`;
            window.open(telegramWebAppUrl, '_blank');
        }

        // –î–µ–º–æ-—Ä–µ–∂–∏–º
        function startDemoMode() {
            hideError();
            loginSection.style.display = 'none';
            loadingSection.style.display = 'block';
            
            setTimeout(() => {
                const userData = generateDemoData();
                displayUserData(userData);
                generateCharts(userData);
                
                loadingSection.style.display = 'none';
                statsSection.style.display = 'block';
            }, 1500);
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
        function generateDemoData() {
            const firstNames = ["–ê–ª–µ–∫—Å–µ–π", "–ú–∞—Ä–∏—è", "–î–º–∏—Ç—Ä–∏–π", "–ê–Ω–Ω–∞", "–ò–≤–∞–Ω", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞", "–°–µ—Ä–≥–µ–π", "–û–ª—å–≥–∞"];
            const lastNames = ["–ò–≤–∞–Ω–æ–≤", "–ü–µ—Ç—Ä–æ–≤–∞", "–°–∏–¥–æ—Ä–æ–≤", "–ö—É–∑–Ω–µ—Ü–æ–≤–∞", "–ü–æ–ø–æ–≤", "–°–º–∏—Ä–Ω–æ–≤–∞", "–í–∞—Å–∏–ª—å–µ–≤", "–ù–æ–≤–∏–∫–æ–≤–∞"];
            const usernames = ["alexey", "maria", "dmitry", "anna", "ivan", "ekaterina", "sergey", "olga"];
            
            const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
            const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
            const username = usernames[Math.floor(Math.random() * usernames.length)];
            
            const registrationDate = new Date();
            registrationDate.setFullYear(registrationDate.getFullYear() - Math.floor(Math.random() * 5) - 1);
            registrationDate.setDate(registrationDate.getDate() - Math.floor(Math.random() * 365));
            
            const firstMessageDate = new Date(registrationDate);
            firstMessageDate.setDate(firstMessageDate.getDate() + Math.floor(Math.random() * 30));
            
            const lastMessageDate = new Date();
            lastMessageDate.setDate(lastMessageDate.getDate() - Math.floor(Math.random() * 7));

            return {
                id: Math.floor(Math.random() * 1000000),
                firstName,
                lastName,
                username,
                photoUrl: null,
                registrationDate,
                publicChats: Math.floor(Math.random() * 50) + 5,
                totalMessages: Math.floor(Math.random() * 10000) + 1000,
                voiceMessages: Math.floor(Math.random() * 200) + 10,
                videoMessages: Math.floor(Math.random() * 100) + 5,
                activeTime: `${Math.floor(Math.random() * 4) + 19}:00-${Math.floor(Math.random() * 4) + 21}:00`,
                lastMessage: formatDate(lastMessageDate),
                fastestReply: Math.floor(Math.random() * 10) + 1,
                commonWords: getRandomWords(),
                firstMessage: formatDate(firstMessageDate),
                pastUsernames: Math.floor(Math.random() * 5) + 1,
                commonSticker: getRandomSticker(),
                activityByHour: generateActivityData(),
                messageTypes: generateMessageTypes()
            };
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
        function formatDate(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}.${month}.${year}`;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–ª–æ–≤
        function getRandomWords() {
            const words = [
                "–ø—Ä–∏–≤–µ—Ç", "—Å–ø–∞—Å–∏–±–æ", "–æ–∫–µ–π", "—Ö–æ—Ä–æ—à–æ", "–ø–æ–Ω—è–ª", 
                "–∫–ª–∞—Å—Å", "–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ", "–∞–≥–∞", "—Ç–æ—á–Ω–æ", "–≤–æ–∑–º–æ–∂–Ω–æ"
            ];
            
            const selected = [];
            for (let i = 0; i < 3; i++) {
                const word = words[Math.floor(Math.random() * words.length)];
                if (!selected.includes(word)) {
                    selected.push(word);
                }
            }
            
            return selected.join(", ");
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å—Ç–∏–∫–µ—Ä–∞
        function getRandomSticker() {
            const stickers = ["üëç", "üòÇ", "‚ù§Ô∏è", "üî•", "üëè", "üôè", "üòç", "üòä"];
            return stickers[Math.floor(Math.random() * stickers.length)];
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ —á–∞—Å–∞–º
        function generateActivityData() {
            const data = [];
            for (let i = 0; i < 24; i++) {
                data.push(Math.floor(Math.random() * 100));
            }
            // –£–≤–µ–ª–∏—á–∏–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –≤–µ—á–µ—Ä–Ω–∏–µ —á–∞—Å—ã
            for (let i = 18; i < 23; i++) {
                data[i] += Math.floor(Math.random() * 50) + 30;
            }
            return data;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç–∏–ø–∞–º —Å–æ–æ–±—â–µ–Ω–∏–π
        function generateMessageTypes() {
            return {
                text: Math.floor(Math.random() * 70) + 20,
                voice: Math.floor(Math.random() * 20) + 5,
                video: Math.floor(Math.random() * 10) + 2,
                sticker: Math.floor(Math.random() * 30) + 10,
                media: Math.floor(Math.random() * 40) + 10
            };
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function displayUserData(data) {
            const userAvatar = document.getElementById('userAvatar');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤–∞—Ç–∞—Ä
            if (data.photoUrl) {
                userAvatar.innerHTML = `<img src="${data.photoUrl}" alt="Avatar" class="user-avatar-img">`;
            } else {
                userAvatar.textContent = data.firstName[0];
            }
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.getElementById('userName').textContent = `${data.firstName} ${data.lastName}`;
            document.getElementById('userStatus').textContent = `@${data.username} ‚Ä¢ –í Telegram —Å ${formatDate(data.registrationDate)}`;
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            const daysSinceRegistration = Math.floor((new Date() - data.registrationDate) / (1000 * 60 * 60 * 24));
            document.getElementById('accountAge').textContent = daysSinceRegistration;
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('publicChats').textContent = data.publicChats;
            document.getElementById('totalMessages').textContent = data.totalMessages.toLocaleString();
            document.getElementById('voiceMessages').textContent = data.voiceMessages;
            document.getElementById('videoMessages').textContent = data.videoMessages;
            document.getElementById('activeTime').textContent = data.activeTime;
            document.getElementById('lastMessage').textContent = data.lastMessage;
            document.getElementById('fastestReply').textContent = data.fastestReply;
            document.getElementById('commonWords').textContent = data.commonWords;
            document.getElementById('firstMessage').textContent = data.firstMessage;
            document.getElementById('pastUsernames').textContent = data.pastUsernames;
            document.getElementById('commonSticker').textContent = data.commonSticker;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
        function generateCharts(data) {
            // –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ —á–∞—Å–∞–º
            const activityChart = document.getElementById('activityChart');
            activityChart.innerHTML = '';
            
            const maxActivity = Math.max(...data.activityByHour);
            
            for (let i = 0; i < 24; i++) {
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                const height = (data.activityByHour[i] / maxActivity) * 100;
                bar.style.height = `${height}%`;
                
                const label = document.createElement('div');
                label.className = 'chart-label';
                label.textContent = `${i}:00`;
                
                bar.appendChild(label);
                activityChart.appendChild(bar);
            }
            
            // –ì—Ä–∞—Ñ–∏–∫ —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
            const messageTypesChart = document.getElementById('messageTypesChart');
            messageTypesChart.innerHTML = '';
            
            const messageTypes = data.messageTypes;
            const totalMessages = Object.values(messageTypes).reduce((a, b) => a + b, 0);
            const types = ['text', 'voice', 'video', 'sticker', 'media'];
            const labels = ['–¢–µ–∫—Å—Ç', '–ì–æ–ª–æ—Å–æ–≤—ã–µ', '–í–∏–¥–µ–æ', '–°—Ç–∏–∫–µ—Ä—ã', '–ú–µ–¥–∏–∞'];
            const colors = ['--tg-blue', '--tg-green', '--tg-purple', '--tg-orange', '--tg-red'];
            
            for (let i = 0; i < types.length; i++) {
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                const percentage = (messageTypes[types[i]] / totalMessages) * 100;
                bar.style.height = `${percentage}%`;
                bar.style.background = `var(${colors[i]})`;
                
                const label = document.createElement('div');
                label.className = 'chart-label';
                label.textContent = labels[i];
                
                bar.appendChild(label);
                messageTypesChart.appendChild(bar);
            }
        }

        // –í—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
        function logout() {
            statsSection.style.display = 'none';
            loginSection.style.display = 'block';
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        webAppBtn.addEventListener('click', openInTelegramWebApp);
        demoBtn.addEventListener('click', startDemoMode);
        logoutBtn.addEventListener('click', logout);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const savedUserData = localStorage.getItem('telegramUserData');
            if (savedUserData) {
                try {
                    const userData = JSON.parse(savedUserData);
                    displayUserData(userData);
                    generateCharts(userData);
                    loginSection.style.display = 'none';
                    statsSection.style.display = 'block';
                } catch (e) {
                    localStorage.removeItem('telegramUserData');
                }
            }
        });
    </script>
</body>
</html>
